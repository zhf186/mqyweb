# æ¼«éª‘æ¸¸é¡¹ç›® - å®Œæ•´éƒ¨ç½²æµç¨‹

## ğŸ¯ å½“å‰çŠ¶æ€

- âœ… é¡¹ç›®ä»£ç å·²å®Œæˆ
- âœ… éƒ¨ç½²é…ç½®å·²åˆ›å»º
- âœ… å¯†ç å·²é…ç½®
- âœ… Git å·²å®‰è£…
- â³ å‡†å¤‡æ¨é€ä»£ç åˆ° GitHub
- â³ å‡†å¤‡éƒ¨ç½²åˆ°é˜¿é‡Œäº‘æœåŠ¡å™¨

---

## ğŸ“‹ å®Œæ•´æµç¨‹ï¼ˆå…± 3 ä¸ªé˜¶æ®µï¼‰

### é˜¶æ®µä¸€ï¼šæ¨é€ä»£ç åˆ° GitHubï¼ˆæœ¬åœ°æ“ä½œï¼‰
### é˜¶æ®µäºŒï¼šè¿æ¥åˆ°æœåŠ¡å™¨ï¼ˆSSH è¿æ¥ï¼‰
### é˜¶æ®µä¸‰ï¼šéƒ¨ç½²é¡¹ç›®ï¼ˆæœåŠ¡å™¨æ“ä½œï¼‰

---

## ğŸš€ é˜¶æ®µä¸€ï¼šæ¨é€ä»£ç åˆ° GitHub

### æ­¥éª¤ 1ï¼šåœ¨æ­£ç¡®ç›®å½•æ‰§è¡Œ Git æ“ä½œ

æ‰“å¼€ PowerShellï¼Œæ‰§è¡Œï¼š

```powershell
# 1. è¿›å…¥æ­£ç¡®çš„é¡¹ç›®ç›®å½•
cd D:\mrcweb1

# 2. ç¡®è®¤ç›®å½•æ­£ç¡®ï¼ˆåº”è¯¥çœ‹åˆ° frontend, backend, deploy ç­‰æ–‡ä»¶å¤¹ï¼‰
ls

# 3. åˆå§‹åŒ– Git ä»“åº“
git init

# 4. é…ç½®ç”¨æˆ·ä¿¡æ¯
git config --global user.name "zhf186"
git config --global user.email "your-email@example.com"

# 5. æ·»åŠ è¿œç¨‹ä»“åº“
git remote add origin git@github.com:zhf186/mqyweb.git

# 6. æ·»åŠ æ‰€æœ‰æ–‡ä»¶
git add .

# 7. æŸ¥çœ‹å°†è¦æäº¤çš„æ–‡ä»¶
git status

# 8. æäº¤ä»£ç 
git commit -m "åˆå§‹æäº¤ï¼šæ¼«éª‘æ¸¸é¡¹ç›®å®Œæ•´ä»£ç å’Œéƒ¨ç½²é…ç½®"

# 9. è®¾ç½®åˆ†æ”¯åä¸º main
git branch -M main

# 10. æ¨é€åˆ° GitHub
git push -u origin main
```

### æ­¥éª¤ 2ï¼šéªŒè¯æ¨é€æˆåŠŸ

```powershell
# æŸ¥çœ‹æ¨é€ç»“æœ
# åº”è¯¥çœ‹åˆ°ç±»ä¼¼è¾“å‡ºï¼š
# To github.com:zhf186/mqyweb.git
#  * [new branch]      main -> main
# Branch 'main' set up to track remote branch 'main' from 'origin'.
```

è®¿é—® GitHub ç¡®è®¤ï¼šhttps://github.com/zhf186/mqyweb

---

## ğŸŒ é˜¶æ®µäºŒï¼šè¿æ¥åˆ°é˜¿é‡Œäº‘æœåŠ¡å™¨

### æ­¥éª¤ 1ï¼šä½¿ç”¨ SSH è¿æ¥æœåŠ¡å™¨

```powershell
# è¿æ¥åˆ°æœåŠ¡å™¨
ssh root@47.37.21.33

# è¾“å…¥å¯†ç åï¼Œæ‚¨ä¼šçœ‹åˆ°æœåŠ¡å™¨çš„å‘½ä»¤è¡Œæç¤ºç¬¦
```

### æ­¥éª¤ 2ï¼šæ£€æŸ¥æœåŠ¡å™¨ç¯å¢ƒ

```bash
# æ£€æŸ¥ Docker
docker --version

# æ£€æŸ¥ Docker Compose
docker-compose --version

# æ£€æŸ¥ Git
git --version

# æ£€æŸ¥ Nginx
nginx -v
```

å¦‚æœæœ‰ä»»ä½•å·¥å…·æœªå®‰è£…ï¼Œè¯·å…ˆå®‰è£…ã€‚

---

## ğŸš€ é˜¶æ®µä¸‰ï¼šåœ¨æœåŠ¡å™¨ä¸Šéƒ¨ç½²é¡¹ç›®

### æ­¥éª¤ 1ï¼šé…ç½® SSH å¯†é’¥ï¼ˆç”¨äº Gitï¼‰

```bash
# 1. ç”Ÿæˆ SSH å¯†é’¥
ssh-keygen -t ed25519 -C "your-email@example.com"
# æŒ‰ Enter ä½¿ç”¨é»˜è®¤è·¯å¾„
# æŒ‰ Enter è·³è¿‡å¯†ç 

# 2. æŸ¥çœ‹å…¬é’¥
cat ~/.ssh/id_ed25519.pub

# 3. å¤åˆ¶å…¬é’¥å†…å®¹
```

**åœ¨æµè§ˆå™¨ä¸­**ï¼š
1. è®¿é—®ï¼šhttps://github.com/settings/keys
2. ç‚¹å‡» "New SSH key"
3. Title: "é˜¿é‡Œäº‘æœåŠ¡å™¨"
4. Key: ç²˜è´´åˆšæ‰å¤åˆ¶çš„å…¬é’¥
5. ç‚¹å‡» "Add SSH key"

**æµ‹è¯•è¿æ¥**ï¼š
```bash
ssh -T git@github.com
# åº”è¯¥æ˜¾ç¤ºï¼šHi zhf186! You've successfully authenticated...
```

### æ­¥éª¤ 2ï¼šå…‹éš†é¡¹ç›®ä»£ç 

```bash
# 1. åˆ›å»ºé¡¹ç›®ç›®å½•
sudo mkdir -p /var/www/manqiyou
sudo chown -R $USER:$USER /var/www/manqiyou

# 2. å…‹éš†ä»£ç 
cd /var/www/manqiyou
git clone git@github.com:zhf186/mqyweb.git .

# 3. ç¡®è®¤æ–‡ä»¶å·²ä¸‹è½½
ls -la
# åº”è¯¥çœ‹åˆ°ï¼šfrontend, backend, deploy, .env.production ç­‰
```

### æ­¥éª¤ 3ï¼šé…ç½®ç¯å¢ƒå˜é‡

```bash
# 1. å¤åˆ¶ç¯å¢ƒå˜é‡æ–‡ä»¶
cp .env.production .env

# 2. æŸ¥çœ‹ç¯å¢ƒå˜é‡ï¼ˆå¯†ç å·²é…ç½®å¥½ï¼‰
cat .env

# ç¯å¢ƒå˜é‡å·²ç»åŒ…å«å¼ºå¯†ç ï¼Œæ— éœ€ä¿®æ”¹
# å¦‚æœéœ€è¦ä¿®æ”¹ï¼Œä½¿ç”¨ï¼šnano .env
```

### æ­¥éª¤ 4ï¼šè¿è¡Œéƒ¨ç½²è„šæœ¬

```bash
# 1. æ·»åŠ æ‰§è¡Œæƒé™
chmod +x deploy/quick-deploy.sh

# 2. è¿è¡Œéƒ¨ç½²è„šæœ¬
bash deploy/quick-deploy.sh
```

**è„šæœ¬ä¼šè‡ªåŠ¨æ‰§è¡Œ**ï¼š
- æ£€æŸ¥ç¯å¢ƒä¾èµ–
- åœæ­¢æ—§å®¹å™¨
- æ„å»º Docker é•œåƒï¼ˆéœ€è¦ 10-15 åˆ†é’Ÿï¼‰
- å¯åŠ¨æ‰€æœ‰å®¹å™¨
- éªŒè¯æœåŠ¡çŠ¶æ€

**ç­‰å¾…æ„å»ºå®Œæˆ**ï¼Œæ‚¨ä¼šçœ‹åˆ°ï¼š
```
âœ“ ç¯å¢ƒæ£€æŸ¥é€šè¿‡
âœ“ é¡¹ç›®ç›®å½•å·²åˆ›å»º
âœ“ ä»£ç å·²æ›´æ–°
âœ“ ç¯å¢ƒå˜é‡é…ç½®å·²å°±ç»ª
âœ“ æ—§å®¹å™¨å·²åœæ­¢
âœ“ Docker å®¹å™¨å·²å¯åŠ¨
âœ“ æœåŠ¡å¯åŠ¨ç­‰å¾…å®Œæˆ
âœ“ æœåŠ¡çŠ¶æ€æ£€æŸ¥å®Œæˆ
```

### æ­¥éª¤ 5ï¼šé…ç½® Nginx

```bash
# 1. å¤åˆ¶ Nginx é…ç½®
sudo cp /var/www/manqiyou/deploy/nginx-manqiyou.conf /etc/nginx/sites-available/manqiyou

# 2. åˆ›å»ºè½¯é“¾æ¥
sudo ln -s /etc/nginx/sites-available/manqiyou /etc/nginx/sites-enabled/

# 3. æµ‹è¯• Nginx é…ç½®
sudo nginx -t

# 4. é‡è½½ Nginx
sudo systemctl reload nginx

# 5. æ£€æŸ¥ Nginx çŠ¶æ€
sudo systemctl status nginx
```

### æ­¥éª¤ 6ï¼šé…ç½® SSL è¯ä¹¦

```bash
# 1. ç¼–è¾‘ SSL è„šæœ¬ï¼Œä¿®æ”¹é‚®ç®±
sudo nano /var/www/manqiyou/deploy/setup-ssl.sh
# æ‰¾åˆ°ï¼šEMAIL="your-email@example.com"
# æ”¹ä¸ºï¼šEMAIL="your-actual-email@example.com"
# ä¿å­˜ï¼šCtrl+X, Y, Enter

# 2. æ·»åŠ æ‰§è¡Œæƒé™
sudo chmod +x /var/www/manqiyou/deploy/setup-ssl.sh

# 3. è¿è¡Œ SSL é…ç½®è„šæœ¬
sudo bash /var/www/manqiyou/deploy/setup-ssl.sh
```

**æŒ‰ç…§æç¤ºæ“ä½œ**ï¼š
- ç¡®è®¤é‚®ç®±åœ°å€
- åŒæ„æœåŠ¡æ¡æ¬¾
- ç­‰å¾…è¯ä¹¦è·å–å®Œæˆ

### æ­¥éª¤ 7ï¼šéªŒè¯éƒ¨ç½²

```bash
# 1. æµ‹è¯• HTTPS è®¿é—®
curl -I https://www.manqiyou.cn

# 2. æµ‹è¯•åç«¯ API
curl https://www.manqiyou.cn/api/health

# 3. æŸ¥çœ‹å®¹å™¨çŠ¶æ€
cd /var/www/manqiyou
docker-compose -f docker-compose.prod.yml ps

# 4. æŸ¥çœ‹æ—¥å¿—
docker-compose -f docker-compose.prod.yml logs -f
# æŒ‰ Ctrl+C é€€å‡ºæ—¥å¿—æŸ¥çœ‹
```

---

## âœ… éƒ¨ç½²å®Œæˆæ£€æŸ¥

### åœ¨æµè§ˆå™¨ä¸­æµ‹è¯•

1. **è®¿é—®ç½‘ç«™**ï¼šhttps://www.manqiyou.cn
   - [ ] é¡µé¢æ­£å¸¸åŠ è½½
   - [ ] æµè§ˆå™¨æ˜¾ç¤ºå®‰å…¨é”å›¾æ ‡
   - [ ] å›¾ç‰‡æ­£å¸¸æ˜¾ç¤º

2. **æµ‹è¯•æ‰€æœ‰é¡µé¢**ï¼š
   - [ ] é¦–é¡µï¼šhttps://www.manqiyou.cn
   - [ ] å…³äºï¼šhttps://www.manqiyou.cn/about
   - [ ] è·¯çº¿ï¼šhttps://www.manqiyou.cn/routes
   - [ ] E-BIKEï¼šhttps://www.manqiyou.cn/ebike
   - [ ] ç¤¾åŒºï¼šhttps://www.manqiyou.cn/community
   - [ ] åˆä½œä¼™ä¼´ï¼šhttps://www.manqiyou.cn/partners
   - [ ] å¥½ç‰©ï¼šhttps://www.manqiyou.cn/goods

3. **æµ‹è¯•åŠŸèƒ½**ï¼š
   - [ ] ä¸­è‹±æ–‡åˆ‡æ¢æ­£å¸¸
   - [ ] ç§»åŠ¨ç«¯å“åº”å¼æ­£å¸¸
   - [ ] åŠ¨ç”»æ•ˆæœæ­£å¸¸
   - [ ] API æ¥å£æ­£å¸¸

---

## ğŸ”§ å¸¸ç”¨ç®¡ç†å‘½ä»¤

### æŸ¥çœ‹æœåŠ¡çŠ¶æ€

```bash
cd /var/www/manqiyou

# æŸ¥çœ‹æ‰€æœ‰å®¹å™¨
docker-compose -f docker-compose.prod.yml ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose -f docker-compose.prod.yml logs -f

# æŸ¥çœ‹ç‰¹å®šæœåŠ¡æ—¥å¿—
docker-compose -f docker-compose.prod.yml logs -f frontend
docker-compose -f docker-compose.prod.yml logs -f backend
```

### é‡å¯æœåŠ¡

```bash
cd /var/www/manqiyou

# é‡å¯æ‰€æœ‰æœåŠ¡
docker-compose -f docker-compose.prod.yml restart

# é‡å¯ç‰¹å®šæœåŠ¡
docker-compose -f docker-compose.prod.yml restart frontend
docker-compose -f docker-compose.prod.yml restart backend
```

### æ›´æ–°ä»£ç 

```bash
cd /var/www/manqiyou

# æ‹‰å–æœ€æ–°ä»£ç 
git pull origin main

# é‡æ–°æ„å»ºå¹¶å¯åŠ¨
docker-compose -f docker-compose.prod.yml up -d --build
```

### æŸ¥çœ‹ Nginx æ—¥å¿—

```bash
# è®¿é—®æ—¥å¿—
sudo tail -f /var/log/nginx/manqiyou_access.log

# é”™è¯¯æ—¥å¿—
sudo tail -f /var/log/nginx/manqiyou_error.log
```

---

## ğŸ› æ•…éšœæ’æŸ¥

### é—®é¢˜ 1ï¼šå®¹å™¨æ— æ³•å¯åŠ¨

```bash
# æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
docker-compose -f docker-compose.prod.yml logs

# æ£€æŸ¥ç«¯å£å ç”¨
sudo netstat -tulpn | grep -E ':(3000|8080|5432|6379)'

# é‡å¯ Docker
sudo systemctl restart docker
```

### é—®é¢˜ 2ï¼šNginx 502 é”™è¯¯

```bash
# æ£€æŸ¥åç«¯æ˜¯å¦è¿è¡Œ
curl http://localhost:8080/api/health

# æŸ¥çœ‹ Nginx é”™è¯¯æ—¥å¿—
sudo tail -f /var/log/nginx/manqiyou_error.log

# æ£€æŸ¥å®¹å™¨çŠ¶æ€
docker-compose -f docker-compose.prod.yml ps
```

### é—®é¢˜ 3ï¼šSSL è¯ä¹¦é—®é¢˜

```bash
# æ£€æŸ¥è¯ä¹¦çŠ¶æ€
sudo certbot certificates

# é‡æ–°è·å–è¯ä¹¦
sudo certbot delete --cert-name www.manqiyou.cn
sudo bash /var/www/manqiyou/deploy/setup-ssl.sh
```

---

## ğŸ“‹ å®Œæ•´å‘½ä»¤é€ŸæŸ¥è¡¨

### æœ¬åœ°æ“ä½œï¼ˆPowerShellï¼‰

```powershell
# æ¨é€ä»£ç 
cd D:\mrcweb1
git init
git add .
git commit -m "åˆå§‹æäº¤"
git branch -M main
git remote add origin git@github.com:zhf186/mqyweb.git
git push -u origin main

# è¿æ¥æœåŠ¡å™¨
ssh root@47.37.21.33
```

### æœåŠ¡å™¨æ“ä½œï¼ˆBashï¼‰

```bash
# é…ç½® SSH å¯†é’¥
ssh-keygen -t ed25519 -C "your-email@example.com"
cat ~/.ssh/id_ed25519.pub
ssh -T git@github.com

# å…‹éš†ä»£ç 
sudo mkdir -p /var/www/manqiyou
sudo chown -R $USER:$USER /var/www/manqiyou
git clone git@github.com:zhf186/mqyweb.git /var/www/manqiyou
cd /var/www/manqiyou

# éƒ¨ç½²
cp .env.production .env
bash deploy/quick-deploy.sh

# é…ç½® Nginx
sudo cp deploy/nginx-manqiyou.conf /etc/nginx/sites-available/manqiyou
sudo ln -s /etc/nginx/sites-available/manqiyou /etc/nginx/sites-enabled/
sudo nginx -t && sudo systemctl reload nginx

# é…ç½® SSL
sudo nano deploy/setup-ssl.sh  # ä¿®æ”¹é‚®ç®±
sudo bash deploy/setup-ssl.sh

# éªŒè¯
curl https://www.manqiyou.cn
docker-compose -f docker-compose.prod.yml ps
```

---

## ğŸ‰ éƒ¨ç½²æˆåŠŸï¼

å½“æ‰€æœ‰æ£€æŸ¥é¡¹éƒ½é€šè¿‡åï¼Œæ‚¨çš„ç½‘ç«™å°±æˆåŠŸéƒ¨ç½²äº†ï¼

**è®¿é—®åœ°å€**ï¼šhttps://www.manqiyou.cn

**æ­å–œï¼æ¼«éª‘æ¸¸é¡¹ç›®å·²æˆåŠŸéƒ¨ç½²åˆ°é˜¿é‡Œäº‘ï¼** ğŸš€

---

## ğŸ“– å‚è€ƒæ–‡æ¡£

- **è¯¦ç»†éƒ¨ç½²æŒ‡å—**ï¼š`deploy/é˜¿é‡Œäº‘éƒ¨ç½²å®Œæ•´æ–¹æ¡ˆ.md`
- **æ£€æŸ¥æ¸…å•**ï¼š`deploy/DEPLOYMENT_CHECKLIST.md`
- **å¿«é€Ÿå‚è€ƒ**ï¼š`deploy/README-ALIYUN.md`
- **é¡¹ç›®æ€»ç»“**ï¼š`PROJECT_SUMMARY.md`

---

**æµç¨‹ç‰ˆæœ¬**: 1.0
**æœ€åæ›´æ–°**: 2025-01-29
**é¢„è®¡æ—¶é—´**: 40-50 åˆ†é’Ÿ
